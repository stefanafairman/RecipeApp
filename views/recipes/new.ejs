<%- include("../partials/header") %>

<div class="container">
    <div class="row">
        <h1 style="text-align: center">Add a New Recipe</h1>
        <div style="width: 30%; margin: 25px auto;">
            <form action="/recipes" method="POST" enctype="multipart/form-data">
                <div class="form-group">
                    <input class="form-control" type="text" name="name" placeholder="name" required>
                </div>
                <!-- <div class="form-group">
                    <input class="form-control" type="text" name="image" placeholder="image url">
                </div> -->

                <div class="form-group">
                    <label for="image">Image</label>
                    <input type="file" name="image" id="image" accept="image/*" required>
                </div>

                <div class="form-group">
                    <input class="form-control" type="text" name="description" placeholder="description">
                </div>
                <div class="form-group">
                    <input class="form-control" type="number" name="serving" placeholder="serving" min="1" step="1">
                </div>
                <div class="form-group">
                    <input class="form-control" type="number" name="ctime" placeholder="cook time">
                </div>
                <div class="form-group">
                    <input class="form-control" type="number" name="ptime" placeholder="prep time">
                </div>
                <!-- <div class="form-group">
                    <input class="form-control" type="text" name="ingredients" placeholder="ingredients">
                </div> -->

                <div class="form-group">
                    <div id="dynamicIngredient">
                        Ingredients <input class="form-control" style="margin-bottom: 5%" type="text" name="ingredients[]" placeholder="ingredients">
                    </div>
                    <input type="button" value="Add another ingredient" onclick="addIngredients('dynamicIngredient');">
                </div>

                <!--Dynamically add steps-->
                <div class="form-group"  id="mrgn">
                    <!-- <input class="form-control" type="text" name="instructions" placeholder="instructions"> -->
                    <div id="dynamicStep">
                        Step 1<br><input class="form-control" style="margin-bottom: 5%" type="text" name="instructions[]" placeholder="instructions">
                    </div>
                    <input type="button" value="Add another step" onclick="addSteps('dynamicStep');">
                </div>

                <div id="mrgn" class="form-group">
                    <button class="btn btn-lg btn-danger btn-block">Submit</button>
                </div>
                
            </form>
            <a href="/recipes">Go Back</a>
        </div>
        
    </div>
</div>

<!--============-->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script>
    var iCounter = 1;
    var iLimit = 20;
    function addIngredients(divName){
        if (iCounter == iLimit)  {
            alert("You have reached the limit of adding " + iCounter + " ingredients");
        }
        else {
            var newdiv = document.createElement('div');
            newdiv.innerHTML = "<input style='margin-bottom: 5%' class='form-control' type='text' name='ingredients[]'>";
            document.getElementById(divName).appendChild(newdiv);
            iCounter++;
        }
    }
</script>

<!--script for dynamically adding more ingredients as needed-->
<script>
    var sCounter = 1;
    var sLimit = 10;
    function addSteps(divName){
        if (sCounter == sLimit)  {
            alert("You have reached the limit of adding " + sCounter + " steps");
        }
        else {
            var newdiv = document.createElement('div');
            newdiv.innerHTML = "Step " + (sCounter + 1) + "<input style='margin-bottom: 5%' class='form-control' type='text' name='instructions[]'>";
            document.getElementById(divName).appendChild(newdiv);
            sCounter++;
        }
    }
</script>
<%- include("../partials/footer") %>